/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/torchvision/io/image.py:13: UserWarning: Failed to load image Python extension: libtorch_cuda_cu.so: cannot open shared object file: No such file or directory
  warn(f"Failed to load image Python extension: {e}")
/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/torch/nn/modules/transformer.py:307: UserWarning: enable_nested_tensor is True, but self.use_nested_tensor is False because encoder_layer.norm_first was True
  warnings.warn(f"enable_nested_tensor is True, but self.use_nested_tensor is False because {why_not_sparsity_fast_path}")
GPU available: True (cuda), used: True
TPU available: False, using: 0 TPU cores
IPU available: False, using: 0 IPUs
HPU available: False, using: 0 HPUs
Namespace(data_cfg='configs/datasets_duet.yaml', model_cfg='configs/model_duet_debug.yaml', train_cfg='configs/train_duet_debug.yaml')
Total parameters: 232012806
Trainable parameters: 109011462
dataset first-round loading done
  0%|          | 0/192 [00:00<?, ?it/s]/home/verma198/Public/dance/tools/../utils/quaternion.py:394: UserWarning: Using torch.cross without specifying the dim arg is deprecated.
Please either pass the dim explicitly or simply use torch.linalg.cross.
The default value of dim will change to agree with that of linalg.cross in a future release. (Triggered internally at ../aten/src/ATen/native/Cross.cpp:62.)
  v = torch.cross(v0, v1)
 54%|█████▍    | 104/192 [00:00<00:00, 1036.63it/s]100%|██████████| 192/192 [00:00<00:00, 1057.27it/s]
dataset first-round loading done
  0%|          | 0/23 [00:00<?, ?it/s]100%|██████████| 23/23 [00:00<00:00, 1082.90it/s]
/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/lightning/pytorch/callbacks/model_checkpoint.py:613: UserWarning: Checkpoint directory ./checkpoints/DEBUG/model exists and is not empty.
  rank_zero_warn(f"Checkpoint directory {dirpath} exists and is not empty.")
LOCAL_RANK: 0 - CUDA_VISIBLE_DEVICES: [0]
/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:60: UserWarning: The verbose parameter is deprecated. Please use get_last_lr() to access the learning rate.
  warnings.warn(

  | Name  | Type      | Params
------------------------------------
0 | model | DuetModel | 232 M 
------------------------------------
109 M     Trainable params
123 M     Non-trainable params
232 M     Total params
928.051   Total estimated model params size (MB)
Sanity Checking: 0it [00:00, ?it/s]                                   /home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/lightning/pytorch/trainer/connectors/data_connector.py:488: PossibleUserWarning: Your `val_dataloader`'s sampler has shuffling enabled, it is strongly recommended that you turn shuffling off for val/test/predict dataloaders.
  rank_zero_warn(
/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/lightning/pytorch/utilities/data.py:110: UserWarning: Total length of `DataLoader` across ranks is zero. Please make sure this was your intention.
  rank_zero_warn(
/home/verma198/miniconda3/envs/dance/lib/python3.8/site-packages/lightning/pytorch/trainer/trainer.py:1609: PossibleUserWarning: The number of training batches (6) is smaller than the logging interval Trainer(log_every_n_steps=50). Set a lower value for log_every_n_steps if you want to see logs for the training epoch.
  rank_zero_warn(
Training: 0it [00:00, ?it/s]Training:   0%|          | 0/6 [00:00<?, ?it/s]Epoch 0:   0%|          | 0/6 [00:00<?, ?it/s] Batch shape: dict_keys(['text', 'music', 'motion_lens', 'cond'])

  0%|          | 0/300 [00:00<?, ?it/s][A
  1%|          | 3/300 [00:00<00:10, 27.56it/s][A
  2%|▏         | 6/300 [00:00<00:10, 28.18it/s][A
  3%|▎         | 9/300 [00:00<00:10, 28.34it/s][A
  4%|▍         | 12/300 [00:00<00:10, 28.45it/s][A
  5%|▌         | 15/300 [00:00<00:09, 28.52it/s][A
  6%|▌         | 18/300 [00:00<00:09, 28.52it/s][A
  7%|▋         | 21/300 [00:00<00:09, 28.56it/s][A
  8%|▊         | 24/300 [00:00<00:09, 28.60it/s][A
  9%|▉         | 27/300 [00:00<00:09, 28.61it/s][A
 10%|█         | 30/300 [00:01<00:09, 28.59it/s][A
 11%|█         | 33/300 [00:01<00:09, 28.61it/s][A
 12%|█▏        | 36/300 [00:01<00:09, 28.63it/s][A
 13%|█▎        | 39/300 [00:01<00:09, 28.63it/s][A
 14%|█▍        | 42/300 [00:01<00:09, 28.64it/s][A
 15%|█▌        | 45/300 [00:01<00:08, 28.64it/s][A
 16%|█▌        | 48/300 [00:01<00:08, 28.63it/s][A
 17%|█▋        | 51/300 [00:01<00:08, 28.62it/s][A
 18%|█▊        | 54/300 [00:01<00:08, 28.62it/s][A
 19%|█▉        | 57/300 [00:01<00:08, 28.60it/s][A
 20%|██        | 60/300 [00:02<00:08, 28.60it/s][A
 21%|██        | 63/300 [00:02<00:08, 28.59it/s][A
 22%|██▏       | 66/300 [00:02<00:08, 28.59it/s][A
 23%|██▎       | 69/300 [00:02<00:08, 28.59it/s][A
 24%|██▍       | 72/300 [00:02<00:07, 28.63it/s][A
 25%|██▌       | 75/300 [00:02<00:07, 28.62it/s][A
 26%|██▌       | 78/300 [00:02<00:07, 28.63it/s][A
 27%|██▋       | 81/300 [00:02<00:07, 28.63it/s][A
 28%|██▊       | 84/300 [00:02<00:07, 28.64it/s][A
 29%|██▉       | 87/300 [00:03<00:07, 28.64it/s][A
 30%|███       | 90/300 [00:03<00:07, 28.62it/s][A
 31%|███       | 93/300 [00:03<00:07, 28.63it/s][A
 32%|███▏      | 96/300 [00:03<00:07, 28.64it/s][A
 33%|███▎      | 99/300 [00:03<00:07, 28.64it/s][A
 34%|███▍      | 102/300 [00:03<00:06, 28.67it/s][A
 35%|███▌      | 105/300 [00:03<00:06, 28.67it/s][A
 36%|███▌      | 108/300 [00:03<00:06, 28.69it/s][A
 37%|███▋      | 111/300 [00:03<00:06, 28.67it/s][A
 38%|███▊      | 114/300 [00:03<00:06, 28.64it/s][A
 39%|███▉      | 117/300 [00:04<00:06, 28.65it/s][A
 40%|████      | 120/300 [00:04<00:06, 28.63it/s][A
 41%|████      | 123/300 [00:04<00:06, 28.63it/s][A
 42%|████▏     | 126/300 [00:04<00:06, 28.64it/s][A
 43%|████▎     | 129/300 [00:04<00:05, 28.66it/s][A
 44%|████▍     | 132/300 [00:04<00:05, 28.65it/s][A
 45%|████▌     | 135/300 [00:04<00:05, 28.66it/s][A
 46%|████▌     | 138/300 [00:04<00:05, 28.64it/s][A
 47%|████▋     | 141/300 [00:04<00:05, 28.66it/s][A
 48%|████▊     | 144/300 [00:05<00:05, 28.68it/s][A
 49%|████▉     | 147/300 [00:05<00:05, 28.65it/s][A
 50%|█████     | 150/300 [00:05<00:05, 28.72it/s][A
 51%|█████     | 153/300 [00:05<00:05, 28.75it/s][A
 52%|█████▏    | 156/300 [00:05<00:05, 28.78it/s][A
 53%|█████▎    | 159/300 [00:05<00:04, 28.79it/s][A
 54%|█████▍    | 162/300 [00:05<00:04, 28.83it/s][A
 55%|█████▌    | 165/300 [00:05<00:04, 28.85it/s][A
 56%|█████▌    | 168/300 [00:05<00:04, 28.86it/s][A
 57%|█████▋    | 171/300 [00:05<00:04, 28.86it/s][A
 58%|█████▊    | 174/300 [00:06<00:04, 28.87it/s][A
 59%|█████▉    | 177/300 [00:06<00:04, 28.88it/s][A
 60%|██████    | 180/300 [00:06<00:04, 28.87it/s][A
 61%|██████    | 183/300 [00:06<00:04, 28.87it/s][A
 62%|██████▏   | 186/300 [00:06<00:03, 28.88it/s][A
 63%|██████▎   | 189/300 [00:06<00:03, 28.89it/s][A
 64%|██████▍   | 192/300 [00:06<00:03, 28.87it/s][A
 65%|██████▌   | 195/300 [00:06<00:03, 28.88it/s][A
 66%|██████▌   | 198/300 [00:06<00:03, 28.89it/s][A
 67%|██████▋   | 201/300 [00:07<00:03, 28.90it/s][A
 68%|██████▊   | 204/300 [00:07<00:03, 28.91it/s][A
 69%|██████▉   | 207/300 [00:07<00:03, 28.88it/s][A
 70%|███████   | 210/300 [00:07<00:03, 28.91it/s][A
 71%|███████   | 213/300 [00:07<00:03, 28.93it/s][A
 72%|███████▏  | 216/300 [00:07<00:02, 28.94it/s][A
 73%|███████▎  | 219/300 [00:07<00:02, 28.94it/s][A
 74%|███████▍  | 222/300 [00:07<00:02, 28.94it/s][A
 75%|███████▌  | 225/300 [00:07<00:02, 28.91it/s][A
 76%|███████▌  | 228/300 [00:07<00:02, 28.91it/s][A
 77%|███████▋  | 231/300 [00:08<00:02, 28.89it/s][A
 78%|███████▊  | 234/300 [00:08<00:02, 28.89it/s][A
 79%|███████▉  | 237/300 [00:08<00:02, 28.90it/s][A
 80%|████████  | 240/300 [00:08<00:02, 28.89it/s][A
 81%|████████  | 243/300 [00:08<00:01, 28.90it/s][A
 82%|████████▏ | 246/300 [00:08<00:01, 28.90it/s][A
 83%|████████▎ | 249/300 [00:08<00:01, 28.91it/s][A
 84%|████████▍ | 252/300 [00:08<00:01, 28.92it/s][A
 85%|████████▌ | 255/300 [00:08<00:01, 28.92it/s][A
 86%|████████▌ | 258/300 [00:08<00:01, 28.92it/s][A
 87%|████████▋ | 261/300 [00:09<00:01, 28.92it/s][A
 88%|████████▊ | 264/300 [00:09<00:01, 28.93it/s][A
 89%|████████▉ | 267/300 [00:09<00:01, 28.91it/s][A
 90%|█████████ | 270/300 [00:09<00:01, 28.93it/s][A
 91%|█████████ | 273/300 [00:09<00:00, 28.95it/s][A
 92%|█████████▏| 276/300 [00:09<00:00, 28.92it/s][A
 93%|█████████▎| 279/300 [00:09<00:00, 28.91it/s][A
 94%|█████████▍| 282/300 [00:09<00:00, 28.94it/s][A
 95%|█████████▌| 285/300 [00:09<00:00, 28.94it/s][A
 96%|█████████▌| 288/300 [00:10<00:00, 28.87it/s][A
 97%|█████████▋| 291/300 [00:10<00:00, 28.86it/s][A
 98%|█████████▊| 294/300 [00:10<00:00, 28.85it/s][A
 99%|█████████▉| 297/300 [00:10<00:00, 28.87it/s][A100%|██████████| 300/300 [00:10<00:00, 28.83it/s]299
299
Epoch 0:  17%|█▋        | 1/6 [00:22<01:50, 22.18s/it]Epoch 0:  17%|█▋        | 1/6 [00:22<01:50, 22.18s/it, v_num=7]
Batch shape: dict_keys(['text', 'music', 'motion_lens', 'cond'])

  0%|          | 0/300 [00:00<?, ?it/s][A
  1%|▏         | 4/300 [00:00<00:09, 30.24it/s][A
  3%|▎         | 8/300 [00:00<00:09, 30.18it/s][A
  4%|▍         | 12/300 [00:00<00:09, 30.15it/s][A
  5%|▌         | 16/300 [00:00<00:09, 30.27it/s][A
  7%|▋         | 20/300 [00:00<00:09, 30.34it/s][A
  8%|▊         | 24/300 [00:00<00:09, 30.38it/s][A
  9%|▉         | 28/300 [00:00<00:08, 30.38it/s][A
 11%|█         | 32/300 [00:01<00:08, 30.41it/s][A
 12%|█▏        | 36/300 [00:01<00:08, 30.44it/s][A
 13%|█▎        | 40/300 [00:01<00:08, 30.22it/s][A
 15%|█▍        | 44/300 [00:01<00:08, 30.19it/s][A
 16%|█▌        | 48/300 [00:01<00:08, 30.28it/s][A
 17%|█▋        | 52/300 [00:01<00:08, 30.34it/s][A
 19%|█▊        | 56/300 [00:01<00:08, 30.38it/s][A
 20%|██        | 60/300 [00:01<00:07, 30.40it/s][A
 21%|██▏       | 64/300 [00:02<00:07, 30.19it/s][A
 23%|██▎       | 68/300 [00:02<00:07, 30.24it/s][A
 24%|██▍       | 72/300 [00:02<00:07, 30.13it/s][A
 25%|██▌       | 76/300 [00:02<00:07, 30.20it/s][A
 27%|██▋       | 80/300 [00:02<00:07, 30.30it/s][A
 28%|██▊       | 84/300 [00:02<00:07, 30.35it/s][A
 29%|██▉       | 88/300 [00:02<00:06, 30.37it/s][A
 31%|███       | 92/300 [00:03<00:06, 30.36it/s][A
 32%|███▏      | 96/300 [00:03<00:06, 30.31it/s][A
 33%|███▎      | 100/300 [00:03<00:06, 30.29it/s][A
 35%|███▍      | 104/300 [00:03<00:06, 30.33it/s][A
 36%|███▌      | 108/300 [00:03<00:06, 30.38it/s][A
 37%|███▋      | 112/300 [00:03<00:06, 30.25it/s][A
 39%|███▊      | 116/300 [00:03<00:06, 30.27it/s][A
 40%|████      | 120/300 [00:03<00:05, 30.31it/s][A
 41%|████▏     | 124/300 [00:04<00:05, 30.37it/s][A
 43%|████▎     | 128/300 [00:04<00:05, 30.37it/s][A
 44%|████▍     | 132/300 [00:04<00:05, 30.41it/s][A
 45%|████▌     | 136/300 [00:04<00:05, 30.36it/s][A
 47%|████▋     | 140/300 [00:04<00:05, 30.36it/s][A
 48%|████▊     | 144/300 [00:04<00:05, 30.40it/s][A
 49%|████▉     | 148/300 [00:04<00:04, 30.41it/s][A
 51%|█████     | 152/300 [00:05<00:04, 30.42it/s][A
 52%|█████▏    | 156/300 [00:05<00:04, 30.43it/s][A
 53%|█████▎    | 160/300 [00:05<00:04, 30.43it/s][A
 55%|█████▍    | 164/300 [00:05<00:04, 30.40it/s][A
 56%|█████▌    | 168/300 [00:05<00:04, 30.30it/s][A
 57%|█████▋    | 172/300 [00:05<00:04, 30.29it/s][A
 59%|█████▊    | 176/300 [00:05<00:04, 30.31it/s][A
 60%|██████    | 180/300 [00:05<00:03, 30.32it/s][A
 61%|██████▏   | 184/300 [00:06<00:03, 30.29it/s][A
 63%|██████▎   | 188/300 [00:06<00:03, 30.31it/s][A
 64%|██████▍   | 192/300 [00:06<00:03, 30.35it/s][A
 65%|██████▌   | 196/300 [00:06<00:03, 30.33it/s][A
 67%|██████▋   | 200/300 [00:06<00:03, 30.18it/s][A
 68%|██████▊   | 204/300 [00:06<00:03, 30.24it/s][A
 69%|██████▉   | 208/300 [00:06<00:03, 30.25it/s][A
 71%|███████   | 212/300 [00:06<00:02, 30.30it/s][A
 72%|███████▏  | 216/300 [00:07<00:02, 30.32it/s][A
 73%|███████▎  | 220/300 [00:07<00:02, 30.32it/s][A
 75%|███████▍  | 224/300 [00:07<00:02, 28.74it/s][A
 76%|███████▌  | 228/300 [00:07<00:02, 29.13it/s][A
 77%|███████▋  | 232/300 [00:07<00:02, 29.42it/s][A
 79%|███████▊  | 236/300 [00:07<00:02, 29.61it/s][A
 80%|████████  | 240/300 [00:07<00:02, 29.75it/s][A
 81%|████████▏ | 244/300 [00:08<00:01, 29.86it/s][A
 83%|████████▎ | 248/300 [00:08<00:01, 29.92it/s][A
 84%|████████▍ | 252/300 [00:08<00:01, 29.97it/s][A